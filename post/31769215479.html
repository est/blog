<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Python良民证算法rev 2</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">Est's Blog </a></h1>
                <nav><ul>
                    <li><a href="/category/photo.html">photo</a></li>
                    <li><a href="/category/stderr.html">stderr</a></li>
                    <li><a href="/category/stdin.html">stdin</a></li>
                    <li class="active"><a href="/category/text.html">text</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/post/31769215479" rel="bookmark"
           title="Permalink to Python良民证算法rev 2">Python良民证算法rev 2</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2012-09-17T21:38:00+00:00">
                Published: Mon 17 September 2012
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/estblog.html">estblog</a>
        </address>
<p>In <a href="/category/text.html">text</a>.</p>
<p>tags: <a href="/tag/python.html">python</a> </p>
</footer><!-- /.post-info -->      <p>以前发过一个<a href="http://initiative.yo2.cn/archives/635924">良民证算法</a></p>
<p>现在发现了一个碉堡的新办法：</p>
<div class="highlight"><pre><span></span>get_id = lambda s: s + &#39;1X864209753&#39;[int(s, 13) % 11]
</pre></div>


<p>来自newsmth的python版：</p>
<div class="highlight"><pre><span></span><span class="err">发信人</span><span class="p">:</span> <span class="n">Andor</span> <span class="p">(</span><span class="err">珍惜</span><span class="p">),</span> <span class="err">信区</span><span class="p">:</span> <span class="n">Python</span>
<span class="err">标</span>  <span class="err">题</span><span class="p">:</span> <span class="n">Re</span><span class="p">:</span> <span class="n">Python的良民证算法</span><span class="err">，有没有更简单的写法？</span>
<span class="err">发信站</span><span class="p">:</span> <span class="err">水木社区</span> <span class="p">(</span><span class="n">Fri</span> <span class="n">Sep</span> <span class="mi">14</span> <span class="mi">15</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="mo">05</span> <span class="mi">2012</span><span class="p">),</span> <span class="err">站内</span>

<span class="n">get_id</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span> <span class="o">+</span> <span class="s1">&#39;1X864209753&#39;</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span> <span class="o">%</span> <span class="mi">11</span><span class="p">]</span>
<span class="err">【</span> <span class="err">在</span> <span class="n">zxn0</span> <span class="p">(</span><span class="n">est</span><span class="p">)</span> <span class="err">的大作中提到</span><span class="p">:</span> <span class="err">】</span>
<span class="p">:</span> <span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="n">get_id</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span><span class="o">+</span><span class="s1">&#39;10X98765432&#39;</span><span class="p">[</span><span class="nb">reduce</span><span class="p">(</span><span class="nb">int</span><span class="o">.</span><span class="fm">__add__</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> 
<span class="p">:</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">-</span><span class="mi">64</span><span class="p">),</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">17</span><span class="p">],</span> <span class="s1">&#39;GIJEHDBAFCGIJEHDB&#39;</span> <span class="p">))</span> <span class="o">%</span> <span class="mi">11</span><span class="p">]</span>
<span class="p">:</span> <span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="n">get_id</span><span class="p">(</span><span class="s1">&#39;34052419800101001&#39;</span><span class="p">)</span>
<span class="p">:</span> <span class="s1">&#39;34052419800101001X&#39;</span>
<span class="p">:</span> <span class="err">大家看哪里还能精简字符不？</span>




<span class="err">发信人</span><span class="p">:</span> <span class="n">Fermat</span> <span class="p">(</span><span class="n">Fermat</span><span class="p">),</span> <span class="err">信区</span><span class="p">:</span> <span class="n">Python</span>
<span class="err">标</span>  <span class="err">题</span><span class="p">:</span> <span class="n">Re</span><span class="p">:</span> <span class="n">Python的良民证算法</span><span class="err">，有没有更简单的写法？</span>
<span class="err">发信站</span><span class="p">:</span> <span class="err">水木社区</span> <span class="p">(</span><span class="n">Mon</span> <span class="n">Sep</span> <span class="mi">17</span> <span class="mo">01</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">42</span> <span class="mi">2012</span><span class="p">),</span> <span class="err">站内</span>

<span class="err">既然</span> <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span> <span class="err">这么漂亮的都出来了，又何必把那么好记的</span> <span class="s2">&quot;10X98765432&quot;</span> <span class="err">弄成一个</span> <span class="n">magic</span> <span class="n">number</span> <span class="err">呢</span>

<span class="n">get_id</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span> <span class="o">+</span> <span class="s1">&#39;10X98765432&#39;</span><span class="p">[(</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span><span class="p">)</span> <span class="o">%</span> <span class="mi">11</span><span class="p">]</span>

<span class="err">或者在有</span><span class="mi">32</span><span class="err">位整数限制的地方使用类似的</span>
<span class="n">get_id</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span> <span class="o">+</span> <span class="s1">&#39;10X98765432&#39;</span><span class="p">[((</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span><span class="o">%</span><span class="mi">11</span><span class="p">)</span><span class="o">*</span><span class="mi">13</span><span class="p">)</span><span class="o">%</span><span class="mi">11</span><span class="p">]</span>


<span class="err">对于有算法洁癖的，下面的可能会好些</span>

<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">chain</span>
<span class="n">get_id</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span> <span class="o">+</span> <span class="s1">&#39;10X98765432&#39;</span><span class="p">[</span><span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">acc</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span>
    <span class="p">(</span><span class="n">acc</span><span class="o">*</span><span class="mi">13</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">%</span> <span class="mi">11</span><span class="p">,</span> <span class="n">chain</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">)]</span>

<span class="err">因为可以把输入字符串当成个无限流，且程序只占用少量固定的空间，也不需要语言对很大的整型有支持。虽然对这个程序没啥意义。</span>
</pre></div>


<p>关于良民证，python普通版描述在<a href="http://www.keakon.net/2009/03/07/%E7%94%A8Python%E8%AE%A1%E7%AE%97%E8%BA%AB%E4%BB%BD%E8%AF%81%E6%A0%A1%E9%AA%8C%E7%A0%81">这里</a>，前六位的来自官方 <a href="http://www.stats.gov.cn/tjbz/index.htm">县及县以上行政区划代码</a></p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>